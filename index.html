<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Asher Zero</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="icon" href="AZ-LOGO-GRAY.png" type="image/png">
    <style>
        /* Form notes styling will be in the external CSS */
    </style>
</head>
<body style="margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background-color: #000000; background-image: url('images/az-week-1-background-image.png'); background-size: cover; background-position: center; background-repeat: no-repeat;">
    <!-- Background Overlay -->
    <div class="background-overlay"></div>
    
    <!-- Logo -->
    <div class="logo">
        <img src="images/AZ-LOGO-GRAY.png" alt="Asher Zero" width="60" height="60">
    </div>
    
    <!-- Main Content -->
    <main>
        <!-- Left Column -->
        <div class="left-column">
            <!-- Weekly Drop Section -->
            <div class="section">
                <h1>AZ WEEK #1 DROP</h1>
                <div class="countdown-timer">
                    <span class="countdown-text">Available for </span>
                    <span id="countdown">
                        <span id="days">0d</span> 
                        <span id="hours">0h</span> 
                        <span id="minutes">0m</span> 
                        <span id="seconds">0s</span>
                    </span>
                </div>
                <div class="tally-form">
                    <form class="email-form" action="https://formspree.io/f/xvgrjvja" method="POST" target="_blank">
                        <input type="hidden" name="_captcha" value="false">
                        <div class="form-group">
                            <input type="text" name="name" placeholder="Artist Name" required>
                        </div>
                        <div class="form-group">
                            <div class="form-input-container">
                                <input type="email" name="email" placeholder="Artist Email" required>
                            </div>
                        </div>
                        <div class="comment-box email-comment">
                            <div class="comment-arrow"></div>
                            <div class="comment-content">
                                <span class="note-emoji">ü§û</span>
                                <span class="note-text">ultra super pinky promise we wont sell ur email. We just wanna know who's here!</span>
                            </div>
                        </div>
                        <div class="button-group">
                            <button type="submit" class="button asher" name="pack" value="asher-bass">
                                <span class="button-icon">ASHER BASS 'WEIGHT' PACK</span>
                            </button>
                            <button type="submit" class="button zero" name="pack" value="zero-drum">
                                <span class="button-icon">ZERO DRUM 'WEIGHT' PACK</span>
                            </button>
                        </div>
                        <div class="comment-box download-comment">
                            <div class="comment-arrow"></div>
                            <div class="comment-content">
                                <span class="note-emoji">‚¨áÔ∏è</span>
                                <span class="note-text">when u input ur email It's gonna auto download, no need to go anywhere.</span>
                            </div>
                        </div>
                        <div class="button-group">
                            <button type="submit" class="button starter-kit" name="pack" value="starter-kit">
                                <span class="button-icon">üéÅ DOWNLOAD STARTER KIT</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Success message will appear here after form submission -->
            <div id="download-message" class="success-message" style="display: none;">
                Your download should start shortly. If it doesn't, please check your email.
            </div>
        </div>
        
        <!-- Social Links -->
        <div class="social-links">
            <a href="https://www.instagram.com/asher.zero/" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
                Instagram
            </a>
            <span class="divider">/</span>
            <a href="https://discord.gg/Wce6vUfzct" target="_blank" rel="noopener noreferrer" aria-label="Discord">
                Discord
            </a>
        </div>
    </main>
    
    <!-- Scripts -->
    <script src="https://tally.so/widgets/embed.js"></script>
    <div class="discord-promo">
        <div class="discord-content">
            <p>Come hang out on Friday!üòé</p>
            <a href="https://discord.gg/Wce6vUfzct" class="discord-button" target="_blank" rel="noopener noreferrer">
                Join the Discord
            </a>
        </div>
    </div>
    <script src="js/countdown.js"></script>
    <script>
        console.log('JavaScript is running!');
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM fully loaded');
            const form = document.querySelector('.email-form');
            const downloadMessage = document.getElementById('download-message');
            
            // Define download paths for each pack
            const downloadPaths = {
                'asher-bass': '/downloads/asher-bass-pack.zip',
                'zero-drum': '/downloads/zero-drum-pack.zip',
                'starter-kit': '/downloads/starter-kit.zip'
            };

            // Handle form submission
            if (form) {
                form.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const submitButton = document.activeElement;
                    const packType = submitButton ? submitButton.value : '';
                    const nameInput = form.querySelector('input[name="name"]');
                    const emailInput = form.querySelector('input[name="email"]');
                    
                    if (!nameInput.value.trim() || !emailInput.value.trim()) {
                        return; // Don't proceed if required fields are empty
                    }
                    
                    // Show loading state
                    downloadMessage.textContent = 'Processing...';
                    downloadMessage.style.display = 'block';
                    downloadMessage.style.opacity = '1';
                    
                    try {
                        // Submit to Formspree
                        const response = await fetch(form.action, {
                            method: 'POST',
                            body: new URLSearchParams({
                                'name': nameInput.value.trim(),
                                'email': emailInput.value.trim(),
                                'pack': packType,
                                '_subject': `New Download: ${packType.replace('-', ' ').toUpperCase()}`
                            }),
                            headers: {
                                'Accept': 'application/json'
                            }
                        });
                        
                        // If it's a pack download, trigger it after successful form submission
                        if (downloadPaths[packType]) {
                            // Show download message
                            downloadMessage.textContent = `Starting download: ${packType.replace('-', ' ').toUpperCase()}...`;
                            
                            // Small delay to ensure form submission is processed
                            setTimeout(() => {
                                // Redirect to download.html with the correct Dropbox key
                                window.location.href = `/download.html?file=${packType}`;
                                
                                // Update message
                                downloadMessage.textContent = 'Download started! Check your downloads folder.';
                            }, 500);
                        }
                        
                        // Hide message after 5 seconds
                        setTimeout(() => {
                            downloadMessage.style.opacity = '0';
                            setTimeout(() => {
                                downloadMessage.style.display = 'none';
                            }, 300);
                        }, 5000);
                        
                    } catch (error) {
                        console.error('Error submitting form:', error);
                        downloadMessage.textContent = 'Error processing your request. Please try again.';
                        downloadMessage.style.display = 'block';
                        downloadMessage.style.opacity = '1';
                        
                        setTimeout(() => {
                            downloadMessage.style.opacity = '0';
                            setTimeout(() => {
                                downloadMessage.style.display = 'none';
                            }, 300);
                        }, 5000);
                    }
                });
            }
        });
    </script>
    <script>
        var d=document,w="https://tally.so/widgets/embed.js",v=function(){"undefined"!=typeof Tally?Tally.loadEmbeds():
        d.querySelectorAll("iframe[data-tally-src]:not([src])").forEach((function(e){e.src=e.dataset.tallySrc}))};
        if("undefined"!=typeof Tally)v();else if(d.querySelector('script[src="'+w+'"]')==null){
        var s=d.createElement("script");s.src=w,s.onload=v,s.onerror=v,d.body.appendChild(s);}
    </script>
    <script>
        // Countdown timer
        function updateCountdown() {
            const now = new Date();
            const target = new Date();
            
            // Set target to next Friday at 5:00 PM
            const daysUntilFriday = (5 - now.getDay() + 7) % 7; // 0 is Sunday, 6 is Saturday
            target.setDate(now.getDate() + (daysUntilFriday || 7)); // If today is Friday, get next Friday
            target.setHours(17, 0, 0, 0); // 5:00 PM
            
            // If it's already past 5 PM on Friday, show next week's Friday
            if (now.getDay() === 5 && now.getHours() >= 17) {
                target.setDate(target.getDate() + 7);
            }
            
            const diff = target - now;
            
            if (diff <= 0) {
                document.getElementById('countdown').innerHTML = 'Available now!';
                return;
            }
            
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            document.getElementById('days').textContent = days + 'd ';
            document.getElementById('hours').textContent = hours + 'h ';
            document.getElementById('minutes').textContent = minutes + 'm ';
            document.getElementById('seconds').textContent = seconds + 's';
        }
        
        // Update countdown every second
        updateCountdown();
        setInterval(updateCountdown, 1000);
    </script>
</body>
</html>
